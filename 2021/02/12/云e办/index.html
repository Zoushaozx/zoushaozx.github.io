<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Javaåç«¯æŠ€æœ¯æ ˆ123456789101112131415springboot springmvc mybatisplus å¯¹é¡¹ç›®ä¾µå…¥å°‘ ä»£ç ç¼–å†™ç®€å•Lombok	æ³¨è§£æ’ä»¶AutoGenerator	Swagger2	æ¥å£æ–‡æ¡£springsecret å®‰å…¨æ¡†æ¶jwt ä»¤ç‰Œcaptcha å›¾å½¢éªŒè¯ç redis	easypoi æ–‡æ¡£å¯¼å…¥å¯¼å‡ºrabbitmq æ¶ˆæ¯é˜Ÿ">
<meta property="og:type" content="article">
<meta property="og:title" content="äº‘eåŠ">
<meta property="og:url" content="http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/index.html">
<meta property="og:site_name" content="Zoux">
<meta property="og:description" content="äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Javaåç«¯æŠ€æœ¯æ ˆ123456789101112131415springboot springmvc mybatisplus å¯¹é¡¹ç›®ä¾µå…¥å°‘ ä»£ç ç¼–å†™ç®€å•Lombok	æ³¨è§£æ’ä»¶AutoGenerator	Swagger2	æ¥å£æ–‡æ¡£springsecret å®‰å…¨æ¡†æ¶jwt ä»¤ç‰Œcaptcha å›¾å½¢éªŒè¯ç redis	easypoi æ–‡æ¡£å¯¼å…¥å¯¼å‡ºrabbitmq æ¶ˆæ¯é˜Ÿ">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-12T19:11:21.000Z">
<meta property="article:modified_time" content="2021-02-17T00:30:18.920Z">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>äº‘eåŠ</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/projects">é¡¹ç›®</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2021/02/12/hexo/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2021/02/12/linux/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&text=äº‘eåŠ"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&is_video=false&description=äº‘eåŠ"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=äº‘eåŠ&body=Check out this article: http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&name=äº‘eåŠ&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&t=äº‘eåŠ"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%91e%E5%8A%9E%EF%BC%8C%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%EF%BC%8C%E5%89%8D%E7%AB%AFvue-%E5%90%8E%E7%AB%AFJava"><span class="toc-number">1.</span> <span class="toc-text">äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Java</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.1.</span> <span class="toc-text">åç«¯æŠ€æœ¯æ ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.2.</span> <span class="toc-text">å‰ç«¯æŠ€æœ¯æ ˆ</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        äº‘eåŠ
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name"></span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-02-12T19:11:21.000Z" itemprop="datePublished">2021-02-12</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue-åç«¯Java"><a href="#äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue-åç«¯Java" class="headerlink" title="äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Java"></a>äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Java</h1><h2 id="åç«¯æŠ€æœ¯æ ˆ"><a href="#åç«¯æŠ€æœ¯æ ˆ" class="headerlink" title="åç«¯æŠ€æœ¯æ ˆ"></a>åç«¯æŠ€æœ¯æ ˆ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">springboot </span><br><span class="line">springmvc </span><br><span class="line">mybatisplus å¯¹é¡¹ç›®ä¾µå…¥å°‘ ä»£ç ç¼–å†™ç®€å•</span><br><span class="line">Lombok	æ³¨è§£æ’ä»¶</span><br><span class="line">AutoGenerator	</span><br><span class="line">Swagger2	æ¥å£æ–‡æ¡£</span><br><span class="line">springsecret å®‰å…¨æ¡†æ¶</span><br><span class="line">jwt ä»¤ç‰Œ</span><br><span class="line">captcha å›¾å½¢éªŒè¯ç </span><br><span class="line">redis	</span><br><span class="line">easypoi æ–‡æ¡£å¯¼å…¥å¯¼å‡º</span><br><span class="line">rabbitmq æ¶ˆæ¯é˜Ÿåˆ— å¼‚æ­¥å¤„ç†</span><br><span class="line">mail é‚®ä»¶ </span><br><span class="line">websocket åœ¨çº¿èŠå¤©</span><br><span class="line">fastDFS æ–‡ä»¶æœåŠ¡å™¨ æ‰¿è½½é™æ€èµ„æº</span><br></pre></td></tr></table></figure>
<h2 id="å‰ç«¯æŠ€æœ¯æ ˆ"><a href="#å‰ç«¯æŠ€æœ¯æ ˆ" class="headerlink" title="å‰ç«¯æŠ€æœ¯æ ˆ"></a>å‰ç«¯æŠ€æœ¯æ ˆ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vue</span><br><span class="line">element UI</span><br><span class="line">vue_cli é¡¹ç›®æ­å»º</span><br><span class="line">vuex çŠ¶æ€ç®¡ç†</span><br><span class="line">vuerouter è·¯ç”±ç®¡ç†</span><br><span class="line">axios é€šè®¯æ¡†æ¶</span><br><span class="line">es6 å‰ç«¯è¯­æ³•</span><br><span class="line">webpack æ‰“åŒ…</span><br><span class="line">websocket åœ¨çº¿èŠå¤©</span><br><span class="line">vue_chat åœ¨çº¿èŠå¤©</span><br><span class="line">font_awesome å­—ä½“</span><br><span class="line">js-file-download æ–‡ä»¶ä¸‹è½½</span><br></pre></td></tr></table></figure>


<p>æ­å»ºåç«¯é¡¹ç›®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">æ­å»ºæ•°æ®åº“ yeb.sql</span><br><span class="line">lombok æ’ä»¶</span><br><span class="line">æ•´ä¸ªé¡¹ç›®é‡‡ç”¨äº†maven èšåˆçš„é¡¹ç›®</span><br><span class="line"></span><br><span class="line">åˆ›å»ºçˆ¶å·¥ç¨‹ï¼š</span><br><span class="line">	1âƒ£ï¸spring initialize-&gt;next-&gt;ä¿®æ”¹Group&#x2F;Artifact-&gt;next-&gt;spring boot devtools-&gt;Project locationï¼ˆé¡¹ç›®å­˜æ”¾åœ°å€ï¼‰</span><br><span class="line">	2âƒ£ï¸çˆ¶å·¥ç¨‹åªæ˜¯ç”¨æ¥åšpomä¾èµ–ç®¡ç†ï¼Œå°±å¯ä»¥åªä¿ç•™pom.xml</span><br><span class="line">	3âƒ£ï¸ä¿®æ”¹pomæ–‡ä»¶</span><br><span class="line">    åˆ é™¤dependenciesæ ‡ç­¾</span><br><span class="line">    åˆ é™¤buildæ ‡ç­¾</span><br><span class="line">    åŠ packagingæ ‡ç­¾</span><br><span class="line">		    &lt;packaging&gt;pom&lt;&#x2F;packaging&gt;</span><br><span class="line">åˆ›å»ºå­é¡¹ç›®ï¼š</span><br><span class="line">	1âƒ£ï¸new-&gt;Module-&gt;Maven-&gt;Create from archetype-&gt;org...:maven-ar..-quickstartç­‰å¾…é»˜è®¤ä¾èµ–åŠ è½½å®Œæˆ</span><br><span class="line">	2âƒ£ï¸åˆ é™¤mainå’Œtestä¸‹é¢çš„Appå’ŒApptestç±»</span><br><span class="line">	3âƒ£ï¸æ›´æ”¹åŒ…åï¼Œcom.xxxx.server</span><br><span class="line">	4âƒ£ï¸ä¿®æ”¹serverçš„pomä¾èµ–</span><br><span class="line">		æˆ‘ä»¬ä¼šå‘ç°ï¼Œçˆ¶å·¥ç¨‹ä¸‹é¢å¤šäº†ï¼Œè¿™ä¸ªæ˜¯å…³è”serverçš„</span><br><span class="line">    &lt;modules&gt;</span><br><span class="line">        &lt;module&gt;yeb-server&lt;&#x2F;module&gt;</span><br><span class="line">    &lt;&#x2F;modules&gt;</span><br><span class="line">    </span><br><span class="line">    æ­¤æ—¶è§‚å¯Ÿserverçš„pomæ˜¯å¦æœ‰å…³è”çˆ¶å·¥ç¨‹çš„parentæ ‡ç­¾ï¼Œæ²¡æœ‰å°±åŠ ä¸Š </span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;artifactId&gt;yeb&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;groupId&gt;com.zoux&lt;&#x2F;groupId&gt;</span><br><span class="line">        &lt;version&gt;0.0.1-SNAPSHOT&lt;&#x2F;version&gt;</span><br><span class="line">    &lt;&#x2F;parent&gt;</span><br><span class="line">    </span><br><span class="line">    nameå’Œurlæ ‡ç­¾å¯ä»¥åˆ é™¤</span><br><span class="line">    </span><br><span class="line">    maven.compiler.source&#x2F;maven.compiler.target ç‰ˆæœ¬æ”¹ä¸º1.8</span><br><span class="line">    </span><br><span class="line">    åˆ é™¤buildæ ‡ç­¾ </span><br><span class="line">    åˆ é™¤dependencyæ ‡ç­¾</span><br><span class="line">    </span><br><span class="line">    æ·»åŠ ä¾èµ–</span><br><span class="line">    	&lt;!--web ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--lombok ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.projectlombok&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;lombok&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;optional&gt;true&lt;&#x2F;optional&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--mysql ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;&#x2F;scope&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--mybatis ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.3.1.tmp&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">         </span><br><span class="line">	5âƒ£ï¸æ–°å»ºresourcesç›®å½•ï¼Œå¹¶è®¾ç½®é…ç½®æ–‡ä»¶</span><br><span class="line">  	åœ¨mainä¸‹é¢æ–°å»ºresourcesï¼Œå¹¶è®¾ç½®ä¸ºsourceç›®å½• mark directory as -&gt; resource root</span><br><span class="line">  	å¹¶åœ¨resourcesé‡Œé¢æ–°å»ºæ–‡ä»¶ï¼Œ</span><br><span class="line">  	application.yml</span><br><span class="line">  	å†…å®¹ï¼š</span><br><span class="line">  		server:</span><br><span class="line"> 			 # ç«¯å£</span><br><span class="line">			  port: 8081</span><br><span class="line"></span><br><span class="line">  		spring:</span><br><span class="line">        #æ•°æ®æºé…ç½®</span><br><span class="line">        datasource:</span><br><span class="line">          driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class="line">          url: jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;yeb?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai</span><br><span class="line">          username: root</span><br><span class="line">          password: rootzoux</span><br><span class="line">          hikari:	</span><br><span class="line">            # è¿æ¥æ± å</span><br><span class="line">            pool-name: DateHikariCP</span><br><span class="line">            # æœ€å°ç©ºé—²è¿æ¥æ•°</span><br><span class="line">            minimum-idle: 5</span><br><span class="line">            #æœ€å¤§è¿æ¥å­˜æ´»æœ€å¤§æ—¶é—´ï¼Œé»˜è®¤600000 10åˆ†é’Ÿ</span><br><span class="line">            idle-timeout: 180000</span><br><span class="line">            #æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤10</span><br><span class="line">            maximum-pool-size: 10</span><br><span class="line">            #ä»è¿æ¥æ± è¿”å›çš„è¿æ¥è‡ªåŠ¨æäº¤</span><br><span class="line">            auto-commit: true</span><br><span class="line">            #è¿æ¥å­˜æ´»çš„æœ€å¤§æ—¶é—´ï¼Œ0è¡¨ç¤ºæ°¸ä¹…å­˜æ´»ï¼Œé»˜è®¤1800000 30åˆ†é’Ÿ</span><br><span class="line">            max-lifetime: 1800000</span><br><span class="line">            #è¿æ¥è¶…æ—¶ï¼Œ30000 é»˜è®¤30ç§’</span><br><span class="line">            connection-timeout: 30000</span><br><span class="line">            #æµ‹è¯•è¿æ¥æ˜¯å¦å¯ç”¨çš„æŸ¥è¯¢è¯­å¥</span><br><span class="line">            connection-test-query: SELECT 1</span><br><span class="line">				# Mabatis-plug é…ç½®</span><br><span class="line">        mybatis-plus:</span><br><span class="line">          #é…ç½® Mapperæ˜ å°„æ–‡ä»¶</span><br><span class="line">          mapper-locations: classpath*:&#x2F;mapper&#x2F;*Mapper.xml</span><br><span class="line">          #é…ç½® Mabatisæ•°æ®è¿”å›ç±»å‹åˆ«å é»˜è®¤åˆ«åæ˜¯ç±»å</span><br><span class="line">          type-aliases-package: com.zoux.server.pojo</span><br><span class="line">          #è‡ªåŠ¨é©¼å³°å‘½å</span><br><span class="line">          configuration:</span><br><span class="line">            map-underscore-to-camel-case: false</span><br><span class="line"></span><br><span class="line">        # mybatis SQL æ‰“å° ï¼ˆæ¥å£æ‰€åœ¨çš„åŒ…ï¼Œä¸æ˜¯mapper.xml æ‰€åœ¨çš„åŒ…ï¼‰</span><br><span class="line">        logging:</span><br><span class="line">          level:</span><br><span class="line">            com.zoux.server.mapper: debug</span><br><span class="line">            </span><br><span class="line">	6âƒ£ï¸åœ¨resourcesç›®å½•ä¸‹æ–°å»ºmapper</span><br><span class="line">	7âƒ£ï¸æ·»åŠ åŒ…åï¼Œpojoï¼Œserviceï¼Œmapperï¼Œservice.impl,controller</span><br><span class="line">	8âƒ£ï¸å¯åŠ¨ç±»YebApplication</span><br><span class="line">			import org.springframework.boot.SpringApplication;</span><br><span class="line">			import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">			@SpringBootApplication</span><br><span class="line">			public class YebAppication &#123;</span><br><span class="line">   			 public static void main(String[] args) &#123;</span><br><span class="line">       			 SpringApplication.run(YebAppication.class, args);</span><br><span class="line">   			 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">	9âƒ£ï¸æ·»åŠ mapperæ‰«æ</span><br><span class="line">	@MapperScan(&quot;com.zoux.server.mapper&quot;)</span><br><span class="line">	ğŸ”Ÿåœ¨resourcesä¸‹æ–°å»ºcomfigç›®å½•ï¼Œå°†YebAppication.yml</span><br></pre></td></tr></table></figure>
<p>é€†å‘å·¥ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®æ–°å»ºpojo mapper controller å•è¡¨æŸ¥è¯¢</span><br><span class="line">mybatisplusï¼Œå®˜ç½‘</span><br><span class="line">https:&#x2F;&#x2F;mp.baomidou.com&#x2F;guide&#x2F;generator.html</span><br><span class="line">é€†å‘å·¥ç¨‹æœ¬èº«ä¸é¡¹ç›®æ²¡æœ‰å¤ªå¤§å…³è”ï¼Œå°±æ–°å»ºmoduleæ‰¿è½½</span><br><span class="line">1âƒ£ï¸æ–°å»ºmoduleï¼Œmavenï¼Œquikerstart</span><br><span class="line">2âƒ£ï¸åˆ é™¤pomï¼Œ nameã€urlæ ‡ç­¾ï¼Œmaven.compiler.source&#x2F;target ç‰ˆæœ¬å·ä¸º1.8ï¼Œåˆ é™¤dependencies&#x2F;buildæ ‡ç­¾</span><br><span class="line">3âƒ£ï¸åˆ é™¤Appç±»ï¼Œæ–°å»ºåŒ…generator</span><br><span class="line">4âƒ£ï¸åˆ é™¤testæ–‡ä»¶å¤¹</span><br><span class="line">5âƒ£ï¸æŒ‡å®šçˆ¶å·¥ç¨‹</span><br><span class="line">	    &lt;parent&gt;</span><br><span class="line">        &lt;artifactId&gt;yeb&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;groupId&gt;com.zoux&lt;&#x2F;groupId&gt;</span><br><span class="line">        &lt;version&gt;0.0.1-SNAPSHOT&lt;&#x2F;version&gt;</span><br><span class="line">   		 &lt;&#x2F;parent&gt;</span><br><span class="line"> 6âƒ£ï¸æ·»åŠ ä¾èµ–</span><br><span class="line"> 		&lt;!--web ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--mybatis ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.3.1.tmp&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--mybatis-plus ä»£ç ç”Ÿæˆå™¨ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-plus-generator&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.3.1.tmp&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--    ferrmarker ä¾èµ– æ¨¡ç‰ˆ--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.freemarker&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;freemarker&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--mysql ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;&#x2F;scope&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">7âƒ£ï¸æ–°å»ºç±»MysqlGenerator</span><br><span class="line">package com.zoux.generator;</span><br><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class="line">import com.baomidou.mybatisplus.core.toolkit.StringPool;</span><br><span class="line">import com.baomidou.mybatisplus.core.toolkit.StringUtils;</span><br><span class="line">import com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line">import com.baomidou.mybatisplus.generator.InjectionConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.*;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.po.TableInfo;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line">import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class MysqlGenerator &#123;</span><br><span class="line">    &#x2F;&#x2F; æ¼”ç¤ºä¾‹å­ï¼Œæ‰§è¡Œ main æ–¹æ³•æ§åˆ¶å°è¾“å…¥æ¨¡å—è¡¨åå›è½¦è‡ªåŠ¨ç”Ÿæˆå¯¹åº”é¡¹ç›®ç›®å½•ä¸­</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * è¯»å–æ§åˆ¶å°å†…å®¹</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static String scanner(String tip) &#123;</span><br><span class="line">        Scanner scanner &#x3D; new Scanner(System.in);</span><br><span class="line">        StringBuilder help &#x3D; new StringBuilder();</span><br><span class="line">        help.append(&quot;è¯·è¾“å…¥&quot; + tip + &quot;ï¼š&quot;);</span><br><span class="line">        System.out.println(help.toString());</span><br><span class="line">        if (scanner.hasNext()) &#123;</span><br><span class="line">            String ipt &#x3D; scanner.next();</span><br><span class="line">            if (StringUtils.isNotBlank(ipt)) &#123;</span><br><span class="line">                return ipt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        throw new MybatisPlusException(&quot;è¯·è¾“å…¥æ­£ç¡®çš„&quot; + tip + &quot;ï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; ä»£ç ç”Ÿæˆå™¨</span><br><span class="line">        AutoGenerator mpg &#x3D; new AutoGenerator();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; å…¨å±€é…ç½®</span><br><span class="line">        GlobalConfig gc &#x3D; new GlobalConfig();</span><br><span class="line">        String projectPath &#x3D; System.getProperty(&quot;user.dir&quot;);</span><br><span class="line">        gc.setOutputDir(projectPath + &quot;&#x2F;yeb-generator&#x2F;src&#x2F;main&#x2F;java&quot;);</span><br><span class="line">        &#x2F;&#x2F;ä½œè€…</span><br><span class="line">        gc.setAuthor(&quot;zoux&quot;);</span><br><span class="line">        &#x2F;&#x2F;æ˜¯å¦æ‰“å¼€è¾“å‡ºç›®å½•</span><br><span class="line">        gc.setOpen(false);</span><br><span class="line">        &#x2F;&#x2F;xml  å¼€å¯BaseResultMap</span><br><span class="line">        gc.setBaseResultMap(true);</span><br><span class="line">        &#x2F;&#x2F;xml  å¼€å¯BaseColumnList</span><br><span class="line">        gc.setBaseColumnList(true);</span><br><span class="line">        &#x2F;&#x2F;å®ä½“å±æ€§ Swagger2 æ³¨è§£</span><br><span class="line">        gc.setSwagger2(true); &#x2F;&#x2F;å®ä½“å±æ€§ Swagger2 æ³¨è§£</span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; æ•°æ®æºé…ç½®</span><br><span class="line">        DataSourceConfig dsc &#x3D; new DataSourceConfig();</span><br><span class="line">        dsc.setUrl(&quot;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;yeb?useUnicode&#x3D;true&amp;useSSL&#x3D;false&amp;characterEncoding&#x3D;utf8&amp;serverTimezone&#x3D;Asia&quot; + &quot;&#x2F;Shanghai&quot;);</span><br><span class="line">        &#x2F;&#x2F; dsc.setSchemaName(&quot;public&quot;);</span><br><span class="line">        dsc.setDriverName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">        dsc.setUsername(&quot;root&quot;);</span><br><span class="line">        dsc.setPassword(&quot;rootzoux&quot;);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; åŒ…é…ç½®</span><br><span class="line">        PackageConfig pc &#x3D; new PackageConfig();</span><br><span class="line">&#x2F;&#x2F;        pc.setModuleName(scanner(&quot;æ¨¡å—å&quot;));</span><br><span class="line">        pc.setParent(&quot;com.zoux&quot;)</span><br><span class="line">                .setEntity(&quot;pojo&quot;)</span><br><span class="line">                .setMapper(&quot;mapper&quot;)</span><br><span class="line">                .setService(&quot;service&quot;)</span><br><span class="line">                .setServiceImpl(&quot;service.impl&quot;)</span><br><span class="line">                .setController(&quot;controller&quot;);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è‡ªå®šä¹‰é…ç½®</span><br><span class="line">        InjectionConfig cfg &#x3D; new InjectionConfig() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void initMap() &#123;</span><br><span class="line">                &#x2F;&#x2F; to do nothing</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; å¦‚æœæ¨¡æ¿å¼•æ“æ˜¯ freemarker</span><br><span class="line">        String templatePath &#x3D; &quot;&#x2F;templates&#x2F;mapper.xml.ftl&quot;;</span><br><span class="line">        &#x2F;&#x2F; å¦‚æœæ¨¡æ¿å¼•æ“æ˜¯ velocity</span><br><span class="line">        &#x2F;&#x2F; String templatePath &#x3D; &quot;&#x2F;templates&#x2F;mapper.xml.vm&quot;;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è‡ªå®šä¹‰è¾“å‡ºé…ç½®</span><br><span class="line">        List&lt;FileOutConfig&gt; focList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">        &#x2F;&#x2F; è‡ªå®šä¹‰é…ç½®ä¼šè¢«ä¼˜å…ˆè¾“å‡º</span><br><span class="line">        focList.add(new FileOutConfig(templatePath) &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public String outputFile(TableInfo tableInfo) &#123;</span><br><span class="line">                &#x2F;&#x2F; è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å ï¼Œ å¦‚æœä½  Entity è®¾ç½®äº†å‰åç¼€ã€æ­¤å¤„æ³¨æ„ xml çš„åç§°ä¼šè·Ÿç€å‘ç”Ÿå˜åŒ–ï¼ï¼</span><br><span class="line">&#x2F;&#x2F;                return projectPath + &quot;&#x2F;src&#x2F;main&#x2F;resources&#x2F;mapper&#x2F;&quot; + pc.getModuleName()</span><br><span class="line">&#x2F;&#x2F;                        + &quot;&#x2F;&quot; + tableInfo.getEntityName() + &quot;Mapper&quot; + StringPool.DOT_XML;</span><br><span class="line">                return projectPath + &quot;&#x2F;yeb-generator&#x2F;src&#x2F;main&#x2F;resources&#x2F;mapper&#x2F;&quot; + tableInfo.getEntityName() + &quot;Mapper&quot; + StringPool.DOT_XML;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        &#x2F;*</span><br><span class="line">        cfg.setFileCreate(new IFileCreate() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean isCreate(ConfigBuilder configBuilder, FileType fileType, String filePath) &#123;</span><br><span class="line">                &#x2F;&#x2F; åˆ¤æ–­è‡ªå®šä¹‰æ–‡ä»¶å¤¹æ˜¯å¦éœ€è¦åˆ›å»º</span><br><span class="line">                checkDir(&quot;è°ƒç”¨é»˜è®¤æ–¹æ³•åˆ›å»ºçš„ç›®å½•ï¼Œè‡ªå®šä¹‰ç›®å½•ç”¨&quot;);</span><br><span class="line">                if (fileType &#x3D;&#x3D; FileType.MAPPER) &#123;</span><br><span class="line">                    &#x2F;&#x2F; å·²ç»ç”Ÿæˆ mapper æ–‡ä»¶åˆ¤æ–­å­˜åœ¨ï¼Œä¸æƒ³é‡æ–°ç”Ÿæˆè¿”å› false</span><br><span class="line">                    return !new File(filePath).exists();</span><br><span class="line">                &#125;</span><br><span class="line">                &#x2F;&#x2F; å…è®¸ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        *&#x2F;</span><br><span class="line">        cfg.setFileOutConfigList(focList);</span><br><span class="line">        mpg.setCfg(cfg);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; é…ç½®æ¨¡æ¿</span><br><span class="line">        TemplateConfig templateConfig &#x3D; new TemplateConfig();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; é…ç½®è‡ªå®šä¹‰è¾“å‡ºæ¨¡æ¿</span><br><span class="line">        &#x2F;&#x2F;æŒ‡å®šè‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„ï¼Œæ³¨æ„ä¸è¦å¸¦ä¸Š.ftl&#x2F;.vm, ä¼šæ ¹æ®ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“è‡ªåŠ¨è¯†åˆ«</span><br><span class="line">        &#x2F;&#x2F; templateConfig.setEntity(&quot;templates&#x2F;entity2.java&quot;);</span><br><span class="line">        &#x2F;&#x2F; templateConfig.setService();</span><br><span class="line">        &#x2F;&#x2F; templateConfig.setController();</span><br><span class="line"></span><br><span class="line">        templateConfig.setXml(null);</span><br><span class="line">        mpg.setTemplate(templateConfig);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; ç­–ç•¥é…ç½®</span><br><span class="line">        StrategyConfig strategy &#x3D; new StrategyConfig();</span><br><span class="line">        &#x2F;&#x2F;æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        &#x2F;&#x2F;æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.no_change);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;strategy.setSuperEntityClass(&quot;ä½ è‡ªå·±çš„çˆ¶ç±»å®ä½“,æ²¡æœ‰å°±ä¸ç”¨è®¾ç½®!&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;lombok æ¨¡å‹</span><br><span class="line">        strategy.setEntityLombokModel(true);</span><br><span class="line">        &#x2F;&#x2F;ç”Ÿæˆ@RestController æ§åˆ¶å™¨ è¿™ä¸ªç›¸å¯¹äºæ™®é€šcontroller è¿”å›æ•°æ®ä¸ºjsonå­—ç¬¦ä¸²</span><br><span class="line">        strategy.setRestControllerStyle(true);</span><br><span class="line">        &#x2F;&#x2F; å…¬å…±çˆ¶ç±»</span><br><span class="line">        &#x2F;&#x2F;strategy.setSuperControllerClass(&quot;ä½ è‡ªå·±çš„çˆ¶ç±»æ§åˆ¶å™¨,æ²¡æœ‰å°±ä¸ç”¨è®¾ç½®!&quot;);</span><br><span class="line">        &#x2F;&#x2F; å†™äºçˆ¶ç±»ä¸­çš„å…¬å…±å­—æ®µ</span><br><span class="line">        &#x2F;&#x2F;strategy.setSuperEntityColumns(&quot;id&quot;);</span><br><span class="line">        strategy.setInclude(scanner(&quot;è¡¨åï¼Œå¤šä¸ªè‹±æ–‡é€—å·åˆ†å‰²&quot;).split(&quot;,&quot;));</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(true);</span><br><span class="line">        &#x2F;&#x2F;è¡¨å‰ç¼€</span><br><span class="line">        &#x2F;&#x2F;strategy.setTablePrefix(pc.getModuleName() + &quot;_&quot;);</span><br><span class="line">        strategy.setTablePrefix(&quot;t_&quot;);</span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line"></span><br><span class="line">        mpg.setTemplateEngine(new FreemarkerTemplateEngine());</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">8âƒ£ï¸è¿è¡Œï¼Œè¾“å…¥è¡¨åï¼Œ</span><br><span class="line">9âƒ£ï¸å°†æ‰€æœ‰ç”Ÿæˆçš„ç±»æ‹·è´åˆ°yeb-server</span><br><span class="line">ğŸ”Ÿæ›´æ”¹è·¯å¾„ï¼Œå’Œæ·»åŠ swaggerä¾èµ–</span><br><span class="line">	        &lt;!--Swagger2 ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger2&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.7.0&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--Swaggerç¬¬ä¸‰æ–¹UIä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.xiaoymin&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;swagger-bootstrap-ui&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.9.6&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Jwt Tokenå·¥å…·ç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸å¼•å…¥jwtï¼Œsecurityä¾èµ–</span><br><span class="line">	 		&lt;!--security ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-security&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--JWT ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.jsonwebtoken&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;jjwt&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.9.0&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">2âƒ£ï¸å¼•å…¥securityé…ç½®ï¼Œapplication.yml</span><br><span class="line">jwt:</span><br><span class="line">  #JWTå­˜å‚¨çš„è¯·æ±‚å¤´</span><br><span class="line">  tokenHeader: Authorization</span><br><span class="line">  #JWT åŠ å¯†ä½¿ç”¨çš„å¯†é’¥</span><br><span class="line">  secret: yeb-secret</span><br><span class="line">  #JWT çš„è¶…æœŸé™æ—¶é—´ ï¼ˆ60*60*24ï¼‰</span><br><span class="line">  expiration: 604800</span><br><span class="line">  #JWT è´Ÿè½½ä¸­æ‹¿åˆ°å¼€å¤´</span><br><span class="line">  tokenHead: Bearer</span><br><span class="line">3âƒ£ï¸æ–°å»ºåŒ…config.security</span><br><span class="line">4âƒ£ï¸æ–°å»ºJwtTokenUtilç±» </span><br><span class="line">5âƒ£ï¸æ·»åŠ æ³¨è§£@Component </span><br><span class="line">	æŠŠæ™®é€špojoå®ä¾‹åŒ–åˆ°springå®¹å™¨ä¸­ï¼Œç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­çš„æ³›æŒ‡å„ç§ç»„ä»¶ï¼Œå°±æ˜¯è¯´å½“æˆ‘ä»¬çš„ç±»ä¸å±äºå„ç§å½’ç±»çš„æ—¶å€™ï¼ˆä¸å±äº@Controllerã€@Servicesç­‰çš„æ—¶å€™ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨@Componentæ¥æ ‡æ³¨è¿™ä¸ªç±»</span><br><span class="line">6âƒ£ï¸å‡†å¤‡è·è½½å˜é‡</span><br><span class="line">	CLAIM_KEY_USERNAME</span><br><span class="line">	CLAIM_KEY_CREATED</span><br><span class="line">	secret</span><br><span class="line">	expiration</span><br><span class="line">	</span><br><span class="line">		private static final String CLAIM_KEY_USERNAME&#x3D;&quot;sub&quot;;</span><br><span class="line">    private static final String CLAIM_KEY_CREATED&#x3D;&quot;created&quot;;</span><br><span class="line">    @Value(&quot;$&#123;jwt.secret&#125;&quot;)</span><br><span class="line">    private String secret;</span><br><span class="line">    @Value(&quot;$&#123;jwt.expiration&#125;&quot;)</span><br><span class="line">    private Long expiration;</span><br><span class="line">    </span><br><span class="line">7âƒ£ï¸ä¸»è¦åŠŸèƒ½</span><br><span class="line">	ä¸€ æ ¹æ®ç”¨æˆ·åç”Ÿæˆtoken</span><br><span class="line">	1ï¼Œæ ¹æ®ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆtoken</span><br><span class="line">		public String generatorToken(UserDetails userDetails) &#123;</span><br><span class="line">        Map&lt;String, Object&gt; claims &#x3D; new HashMap&lt;&gt;();</span><br><span class="line">        claims.put(CLAIM_KEY_USERNAME, userDetails.getUsername());</span><br><span class="line">        claims.put(CLAIM_KEY_CREATED, new Date());</span><br><span class="line">        return generatorToken();</span><br><span class="line">        &#125;</span><br><span class="line">  2ï¼Œæ ¹æ®è·è½½ç”ŸæˆJWT TOKEN</span><br><span class="line">  	private String generatorToken(Map&lt;String,Object&gt; claims) &#123;</span><br><span class="line">        return Jwts.builder()</span><br><span class="line">                .setClaims(claims)</span><br><span class="line">                .setExpiration(generateExpirationDate())</span><br><span class="line">                .signWith(SignatureAlgorithm.ES512,secret)</span><br><span class="line">                .compact();</span><br><span class="line">                &#125;</span><br><span class="line">  3ï¼Œç”Ÿæˆtokenå¤±æ•ˆæ—¶é—´</span><br><span class="line">   private Date generateExpirationDate() &#123;</span><br><span class="line">        return new Date(System.currentTimeMillis() + expiration * 1000);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"> äºŒ ä»tokenæ‹¿ç”¨æˆ·å</span><br><span class="line">  1ï¼Œä»tokenä¸­è·å¾—ç™»å½•ç”¨æˆ·å</span><br><span class="line">  public String getUserNameFromToken(String token) &#123;</span><br><span class="line">        String username;</span><br><span class="line">        try &#123;</span><br><span class="line">            Claims claims &#x3D; getClaimsFromToken(token);</span><br><span class="line">            username &#x3D; claims.getSubject();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            username &#x3D; null;</span><br><span class="line">        &#125;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line">  2ï¼Œä»tokené‡Œé¢è·å–è·è½½</span><br><span class="line">  private Claims getClaimsFromToken(String token) &#123;</span><br><span class="line">        Claims claims &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            claims &#x3D; Jwts.parser()</span><br><span class="line">                    .setSigningKey(secret)</span><br><span class="line">                    .parseClaimsJws(token)</span><br><span class="line">                    .getBody();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return claims;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">	ä¸‰ åˆ¤æ–­tokenæ˜¯å¦å¤±æ•ˆ</span><br><span class="line">	1ï¼Œtokenæ˜¯å¦è¿‡æœŸ</span><br><span class="line">	 private boolean isTokenExpired(String token) &#123;</span><br><span class="line">        Date expiredDate &#x3D; getExpiredDateFromToken(token);</span><br><span class="line">        return expiredDate.before(new Date());</span><br><span class="line">    &#125;</span><br><span class="line">    private Date getExpiredDateFromToken(String token) &#123;</span><br><span class="line">        Claims claims &#x3D; getClaimsFromToken(token);</span><br><span class="line">        return claims.getExpiration();</span><br><span class="line">    &#125;</span><br><span class="line">	2ï¼Œtokené‡Œé¢çš„ç”¨æˆ·åä¸userDetailé‡Œé¢ç”¨æˆ·åæ˜¯å¦ä¸€è‡´</span><br><span class="line">	public boolean validateToken(String token, UserDetails userDetails) &#123;</span><br><span class="line">        String username &#x3D; getUserNameFromToken(token);</span><br><span class="line">        return username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">	å›› æ˜¯å¦å¯ä»¥åˆ·æ–°token</span><br><span class="line">	 public boolean canRefresh(String token) &#123;</span><br><span class="line">        return !isTokenExpired(token);</span><br><span class="line">    &#125;</span><br><span class="line">	äº” åˆ·æ–°token</span><br><span class="line">	public String refreshToken(String token) &#123;</span><br><span class="line">        Claims claims &#x3D; getClaimsFromToken(token);</span><br><span class="line">        claims.put(CLAIM_KEY_CREATED, new Date());</span><br><span class="line">        return generatorToken(claims);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å…¬å…±è¿”å›å¯¹è±¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ç™»å½•æµç¨‹ï¼š</span><br><span class="line">	å‰ç«¯ä¼ ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">	åç«¯æ ¡éªŒç”¨æˆ·åå’Œå¯†ç ï¼Œ</span><br><span class="line">		æœ‰é”™è¯¯å°±é‡æ–°è¾“å…¥</span><br><span class="line">		æ­£ç¡®å°±ä¼šç”ŸæˆJWTä»¤ç‰Œï¼Œå¹¶ä¸”è¿”å›ç»™å‰ç«¯ï¼Œå‰ç«¯è·å¾—JWTä»¤ç‰Œå°±ä¼šæ”¾å…¥åˆ°è¯·æ±‚å¤´é‡Œé¢ï¼Œä»»ä½•è¯·æ±‚éƒ½ä¼šæºå¸¦JWTä»¤ç‰Œï¼Œ</span><br><span class="line">		åç«¯ä¼šæœ‰å¯¹åº”çš„æ‹¦æˆªå™¨ï¼Œå¯¹JWTä»¤ç‰Œåšç›¸åº”çš„éªŒè¯ï¼ŒéªŒè¯é€šè¿‡æ‰èƒ½è®¿é—®å¯¹åº”çš„æ¥å£ï¼ŒéªŒè¯ä¸é€šè¿‡ï¼Œä»¤ç‰Œå¯èƒ½å¤±æ•ˆäº†ï¼Œå¯èƒ½æ˜¯ç”¨æˆ·åæœ‰é—®é¢˜ï¼Œæˆ–è€…å¯†ç æœ‰é—®é¢˜ï¼Œä¸æ˜¯åˆæ³•ç™»é™†</span><br><span class="line">		</span><br><span class="line">1âƒ£ï¸åœ¨pojoæ–°å»ºå…¬å…±è¿”å›å¯¹è±¡RespBean</span><br><span class="line">2âƒ£ï¸åŠ æ³¨è§£@Dataï¼Œç”Ÿæˆgetters and setters</span><br><span class="line">	@NoArgsConstructor æ— å‚</span><br><span class="line">	@AllArgsConstructor	æœ‰å‚</span><br><span class="line">3âƒ£ï¸æˆåŠŸï¼Œå¤±è´¥è¿”å›æ–¹æ³•ï¼Œå…¬å…±å˜é‡ï¼Œcode message obj</span><br><span class="line"> public static RespBean success(String message) &#123;</span><br><span class="line">        return new RespBean(200, message, null);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ç™»å½•ä¹‹åè¿”å›token</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ å‰ç«¯ä¼ ç”¨æˆ·åå¯†ç ï¼Œåç«¯æ ¡éªŒ</span><br><span class="line">	1âƒ£ï¸Adminç±»ï¼Œé‡Œé¢å®ç°springsecurityæ¡†æ¶UserDetails</span><br><span class="line">	å®ç°æ–¹æ³•ï¼Œé™¤äº†getAuthoritiesçš„è¿”å›å€¼ä¸å˜ï¼ŒisEnabledè¿”å›å€¼ä¸ºå±æ€§å­—æ®µenabledï¼Œ</span><br><span class="line">	å…¶ä»–çš„éƒ½è¿”å›true</span><br><span class="line">	2âƒ£ï¸æ–°å»ºç™»é™†å®ä½“ç±» AdminLoginParam</span><br><span class="line">		æ·»åŠ lombokæ³¨è§£</span><br><span class="line">			@Data</span><br><span class="line">			@EqualsAndHashCode æ­¤æ³¨è§£ä¼šç”Ÿæˆequals(Object other) å’Œ hashCode()æ–¹æ³• callSuperæ˜¯å¦è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•</span><br><span class="line">			@Accessors(chain &#x3D; true)ï¼ŒAccessorsç¿»è¯‘æ˜¯å­˜å–å™¨ã€‚é€šè¿‡è¯¥æ³¨è§£å¯ä»¥æ§åˆ¶getterå’Œsetteræ–¹æ³•çš„å½¢å¼chainä¸ºtrueï¼Œsetteræ–¹æ³•è¿”å›å½“å‰å¯¹è±¡</span><br><span class="line">		  @ApiModel(value &#x3D; &quot;AdminLoginå¯¹å¯¹è±¡&quot;,description &#x3D; &quot;&quot; swaggeræ³¨è§£</span><br><span class="line">		  @ApiModelProperty(value &#x3D; &quot;å¯†ç &quot;,required &#x3D; true) swaggeræ³¨è§£ï¼Œrequiredæ˜¯å¦å¿…å¡«</span><br><span class="line">	3âƒ£ï¸controllerç¼–å†™ï¼ŒLoginController</span><br><span class="line">		æ³¨è§£ï¼š</span><br><span class="line">			@Api(tags &#x3D; &quot;LoginController&quot;) è¡¨ç¤ºæ ‡è¯†è¿™ä¸ªç±»æ˜¯swaggerçš„èµ„æº </span><br><span class="line">			@RestController ç­‰åŒäº@Controller + @ResponseBodyï¼Œè¡¨æ˜äº†è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ç±»+è¡¨ç¤ºæ–¹æ³•çš„è¿”å›å€¼ç›´æ¥ä»¥æŒ‡å®šçš„æ ¼å¼å†™å…¥Http response body</span><br><span class="line">      @ApiOperation(value &#x3D; &quot;ç™»é™†ä¹‹åè¿”å›token&quot;)è¡¨ç¤ºä¸€ä¸ªhttpè¯·æ±‚çš„æ“ä½œ </span><br><span class="line">       @PostMapping(&quot;&#x2F;login&quot;) æ˜ å°„ä¸€ä¸ªPOSTè¯·æ±‚ </span><br><span class="line">   4âƒ£ï¸æ·»åŠ æ–¹æ³• loginï¼Œå‚æ•° AdminLoginParamï¼ŒHttpServletRequest</span><br><span class="line">      public RespBean login(AdminLoginParam adminLoginParam, HttpServletRequest request);</span><br><span class="line">   5âƒ£ï¸å¼•å…¥IAdminServiceï¼Œå¹¶åŠ å…¥æ–¹æ³•loginï¼Œå‚æ•°ï¼ˆç”¨æˆ·åï¼Œå¯†ç ï¼Œrequestï¼‰</span><br><span class="line">   6âƒ£ï¸åœ¨IAminServiceé‡Œé¢å®ç°login</span><br><span class="line">   7âƒ£ï¸åœ¨AdminServiceImplå®ç°login</span><br><span class="line">   	 æ³¨å…¥UserDetailsService</span><br><span class="line">   	 é€šè¿‡UserDetailsServiceï¼Œè·å¾—UserDetails</span><br><span class="line">   	 æ³¨å…¥PasswordEncoder</span><br><span class="line">   	 åˆ©ç”¨PasswordEncoder åŒ¹é…ä¸€ä¸‹å¯†ç </span><br><span class="line">   	 åˆ¤æ–­userDetailsè´¦æˆ·æ˜¯å¦ç¦ç”¨</span><br><span class="line">   	 æ³¨å…¥JWTå·¥å…·ç±»</span><br><span class="line">   	 ç”Ÿæˆtoken</span><br><span class="line">   	 æ³¨å…¥tokenHeadï¼Œjwté…ç½®</span><br><span class="line">   	 å°†tokenè£…å…¥map</span><br><span class="line">		 ä½¿ç”¨springsecurityæ¡†æ¶ï¼Œç™»é™†æˆåŠŸåï¼Œè·å–ç”¨æˆ·ä¿¡æ¯å¯ä»¥ä½¿ç”¨springsecurityæä¾›çš„å¯¹è±¡userdetailsç­‰</span><br><span class="line">		 æ‰€ä»¥ç™»å½•æ—¶ï¼Œè¦å°†ç”¨æˆ·ä¿¡æ¯æ”¾å…¥springsecurityå…¨æ–‡ä¸­</span><br><span class="line">		 UsernamePasswordAuthenticationToken authenticationToken &#x3D; new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities());</span><br><span class="line">        SecurityContextHolder.getContext().setAuthentication(authenticationToken);</span><br><span class="line">	8âƒ£ï¸passwordEncoderå¯¹è±¡ç­‰å¾…å¤„ç†</span><br></pre></td></tr></table></figure>
<p>è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç™»é™†æ—¶å°†å½“å‰ç™»å½•å¯¹è±¡è®¾åˆ¶åˆ°springsecurityå…¨å±€ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨Principalè·å–å½“å‰ç™»å½•ç”¨æˆ·å¯¹è±¡</span><br><span class="line">1âƒ£ï¸åœ¨LoginControlleræ–°å»ºæ–¹æ³•getAdminInfo</span><br><span class="line">2âƒ£ï¸åˆ©ç”¨Principalè·å–ç”¨æˆ·å¯¹è±¡</span><br><span class="line">3âƒ£ï¸å°†è·å¾—adminå¯¹è±¡å¯†ç ç½®ç©ºï¼Œé¿å…å‰ç«¯è·å–æ˜æ–‡å¯†ç </span><br><span class="line">4âƒ£ï¸åœ¨IAdminServiceå®šä¹‰getAdminByUserName</span><br><span class="line">5âƒ£ï¸åœ¨AdminServiceImplå®ç°getAdminByUserName</span><br><span class="line">	æ³¨å…¥AdminMapper</span><br><span class="line">	return adminMapper.selectOne(</span><br><span class="line">			newQueryWrapper&lt;Admin()</span><br><span class="line">					   .eq(&quot;username&quot;,username)</span><br><span class="line">					   .eq(&quot;enabled&quot;, true)</span><br><span class="line">					   );</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é€€å‡ºç™»å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åç«¯è¿”å›200çŠ¶æ€ç ï¼Œå‰ç«¯æ ¹æ®çŠ¶æ€ç ï¼Œå°†è¯·æ±‚å¤´é‡Œé¢çš„tokenåˆ é™¤ </span><br><span class="line">1âƒ£ï¸åœ¨LoginControlleré‡Œé¢ æ–°å»ºæ–¹æ³•logout è¿”å›çŠ¶æ€ç 200</span><br></pre></td></tr></table></figure>
<p>é…ç½®securityç™»é™†è¿‡æ»¤å™¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸å‡†å¤‡é…ç½®ç±»SecurityConfigï¼Œç»§æ‰¿ WebSecurityConfigurerAdapter</span><br><span class="line">2âƒ£ï¸æ³¨è§£@Configuration</span><br><span class="line">3âƒ£ï¸æ³¨å…¥Bean UserDetailsServiceï¼Œé‡å†™è¿™ä¸ªå®¹å™¨é‡Œçš„</span><br><span class="line">		@Override</span><br><span class="line">    @Bean</span><br><span class="line">    public UserDetailsService userDetailsService() &#123;</span><br><span class="line">        return username -&gt; &#123;</span><br><span class="line">            Admin admin &#x3D; adminService.getAdminByUserName(username);</span><br><span class="line">            if (null !&#x3D; admin) &#123;</span><br><span class="line">                return admin;</span><br><span class="line">            &#125;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">4âƒ£ï¸é‡å†™configureæ–¹æ³•ï¼Œèƒ½å¤Ÿå°†æˆ‘ä»¬é‡å†™çš„UserDetyailsService æ³¨å…¥åˆ°springsecurit</span><br><span class="line">5âƒ£ï¸å®ç°passwordEncoderå®¹å™¨</span><br><span class="line">6âƒ£ï¸é‡å†™springsecurityé…ç½®configure(HttpSecurity http)</span><br><span class="line">	å…³é—­scrfï¼Œä½¿ç”¨JWTä¸éœ€è¦csrf</span><br><span class="line">	 http.csrf()</span><br><span class="line">        .disable()</span><br><span class="line">	å…³é—­sessionç›¸å…³çš„</span><br><span class="line">		åŸºäºtokenä¸éœ€è¦session</span><br><span class="line">                .sessionManagement()</span><br><span class="line">                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)</span><br><span class="line">	å…è®¸ç™»é™†è®¿é—®</span><br><span class="line">		.antMatchers(&quot;&#x2F;login&quot;, &quot;logout&quot;)</span><br><span class="line">	é…ç½®ç”Ÿæ•ˆ</span><br><span class="line">		.permitAll();</span><br><span class="line">	è®¿é—®è¯·æ±‚è¦æ±‚è®¤è¯</span><br><span class="line">                .anyRequest()</span><br><span class="line">                .authenticated()</span><br><span class="line">   ç¼“å­˜å…³é—­</span><br><span class="line">                .headers()</span><br><span class="line">                .cacheControl();</span><br><span class="line">   æ·»åŠ jwtç™»é™†æˆæƒæ‹¦æˆªå™¨</span><br><span class="line">        http.addFilterBefore();</span><br><span class="line">   è‡ªå®šä¹‰æœªæˆæƒï¼Œæˆ–è€…æœªç™»å½•çš„ç»“æœè¿”å›</span><br><span class="line">        http.exceptionHandling()</span><br><span class="line">                .accessDeniedHandler()</span><br><span class="line">                .authenticationEntryPoint();</span><br><span class="line">7âƒ£ï¸å‡†å¤‡jwtçš„ç™»é™†è¿‡æ»¤å™¨ JwtAuthorizationTokenFilter ç»§æ‰¿OncePerRequestFilter é‡å†™doFilterInternal&#x3D;&#x3D;ç›¸å½“äºå‰ç½®æ‹¦æˆª</span><br><span class="line">	é€šè¿‡requestè·å–Header</span><br><span class="line">	è¿›è¡Œtokenæ ¡éªŒ</span><br><span class="line">		tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenæ˜¯å¦ä»¥tokenHeadä¸ºå¼€å¤´</span><br><span class="line">	åˆ©ç”¨JwtUtilsè·å–ç”¨æˆ·å</span><br><span class="line">	è¿›è¡Œç”¨æˆ·ååˆ¤æ–­</span><br><span class="line">		åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦ä¸ºç©ºï¼ŒåŒæ—¶æ£€æŸ¥springsecurityå…¨å±€ä¸Šä¸‹æ–‡æ‰¾ä¸åˆ°ç”¨æˆ·å¯¹è±¡ï¼Œå³æœªç™»å½•</span><br><span class="line">	è·å–userdetailsï¼Œç›¸å½“äºç™»é™†äº†</span><br><span class="line">	åˆ¤æ–­tokenæ˜¯å¦æœ‰æ•ˆï¼Œæœ‰æ•ˆå°±å°†tokené‡æ–°æ”¾å…¥ç”¨æˆ·å¯¹è±¡	</span><br><span class="line">		é‡æ–°è®¾ç½®ç”¨æˆ·å¯¹è±¡,æ›´æ–°è·è½½</span><br><span class="line">		é‡æ–°è®¾ç½®ç”¨æˆ·å¯¹è±¡ï¼Œæ›´æ–°details</span><br><span class="line">		è®¾ç½®springsecurityå…¨å±€ä¸Šä¸‹æ–‡</span><br><span class="line">	ç»è¿‡ä¸€ç³»åˆ—éªŒè¯ï¼Œæœ€åè¿›è¡Œæ”¾è¡Œ</span><br><span class="line">8âƒ£ï¸å›åˆ°SecurityConfigç±»ï¼Œåˆ©ç”¨Beanæ³¨è§£å°†JwtAuthorizationTokenFilteræš´éœ²å‡ºæ¥</span><br><span class="line">	å¹¶å¡«å…¥ã€æ·»åŠ jwtç™»é™†æˆæƒæ‹¦æˆªå™¨ã€‘åŒæ—¶åŠ ä¸Šå‚æ•°ï¼ŒUsernamePasswordAuthenticationFilter.class</span><br></pre></td></tr></table></figure>
<p>securityè‡ªå®šä¹‰è¿”å›ç»“æœ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸æ–°å»ºç±»RestAuthorizationEntryPointï¼Œå®ç°AuthenticationEntryPoint</span><br><span class="line">2âƒ£ï¸é€šè¿‡responseè®¾ç½®å­—ç¬¦é›†</span><br><span class="line">3âƒ£ï¸è®¾ç½®æ•°æ®äº¤æµæ ¼å¼</span><br><span class="line">4âƒ£ï¸è·å–è¾“å‡ºæµ</span><br><span class="line">5âƒ£ï¸è‡ªå®šä¹‰è¿”å›ç±»å‹</span><br><span class="line"></span><br><span class="line">1âƒ£ï¸æ–°å»ºç±»RestfulAccessDeniedHandlerå®ç°AccessDeniedHandleré‡å†™handleæ–¹æ³•</span><br><span class="line">2âƒ£ï¸é€šè¿‡responseè®¾ç½®å­—ç¬¦é›†</span><br><span class="line">3âƒ£ï¸è®¾ç½®æ•°æ®äº¤æµæ ¼å¼</span><br><span class="line">4âƒ£ï¸è·å–è¾“å‡ºæµ</span><br><span class="line">5âƒ£ï¸è‡ªå®šä¹‰è¿”å›ç±»å‹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åœ¨SecurityConfigç±»ä¸­è¿›è¡Œæ³¨å…¥RestAuthorizationEntryPointï¼ŒRestfulAccessDeniedHandler</span><br><span class="line">å°†æ³¨å…¥çš„ä¸¤ä¸ªç±»æ”¾å…¥é…ç½®ä¸­</span><br></pre></td></tr></table></figure>
<p>swagger2é…èµ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸pomä¾èµ–</span><br><span class="line">	 &lt;!--Swagger2 ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger2&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.7.0&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--Swaggerç¬¬ä¸‰æ–¹UIä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.xiaoymin&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;swagger-bootstrap-ui&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.9.6&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line"> 2âƒ£ï¸é…ç½®swaggerï¼Œæ–°å»ºSwagger2Configç±»</span><br><span class="line"> 		æ³¨è§£</span><br><span class="line"> 		@Component é…ç½®ç±»</span><br><span class="line">		@EnableSwagger2 å¼€å¯swagger2</span><br><span class="line"> 3âƒ£ï¸å‡†å¤‡APiInfo</span><br><span class="line"> 4âƒ£ï¸æ³¨å…¥beanï¼Œè§„å®šæ‰«æé‚£äº›åŒ…ï¼Œå…·ä½“ä»€ä¹ˆåŒ…ï¼Œä»»æ„è·¯å¾„	 	</span><br><span class="line"> 5âƒ£ï¸å¯åŠ¨æµ‹è¯•ï¼Œé‡å†™å…è®¸é€šè¿‡æ–¹æ³•ï¼Œæ·»åŠ é€šè¿‡èµ„æº</span><br><span class="line"> 	 public void configure(WebSecurity web) throws Exception &#123;</span><br><span class="line">        web.ignoring().antMatchers(</span><br><span class="line">                &quot;&#x2F;login&quot;,</span><br><span class="line">                &quot;&#x2F;logout&quot;,</span><br><span class="line">                &quot;&#x2F;css&#x2F;**&quot;,</span><br><span class="line">                &quot;&#x2F;js&#x2F;**&quot;,</span><br><span class="line">                &quot;&#x2F;index.html&quot;,</span><br><span class="line">                &quot;favicon.ico&quot;,</span><br><span class="line">                &quot;&#x2F;doc.html&quot;,</span><br><span class="line">                &quot;&#x2F;webjars&#x2F;**&quot;,</span><br><span class="line">                &quot;&#x2F;swagger-resources&#x2F;**&quot;,</span><br><span class="line">                &quot;&#x2F;v2&#x2F;api-docs&#x2F;**&quot;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>swagger2æä¾›Authorize</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">å®ç°å…¨å±€ç™»å½•</span><br><span class="line">1âƒ£ï¸åœ¨swagger2configç±»createRestApiæ–¹æ³•é‡Œé¢ç»§ç»­æ·»åŠ  </span><br><span class="line">																	.securityContexts()</span><br><span class="line">									                .securitySchemes();</span><br><span class="line">2âƒ£ï¸å®ŒæˆsecuritySchemes</span><br><span class="line">	è®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯</span><br><span class="line">		æ–°å»ºList</span><br><span class="line">		æ–°å»ºApiKeyï¼Œä¸‰ä¸ªå‚æ•°</span><br><span class="line">		å°†ApiKeyåŠ å…¥List</span><br><span class="line">		è¿”å›List</span><br><span class="line">3âƒ£ï¸å®ŒæˆsecurityContexts</span><br><span class="line">	è®¾ç½®ç™»é™†è®¿é—®è®¤è¯è·¯å¾„</span><br><span class="line">	result.add(getContextByPath(&quot;&#x2F;hello&#x2F;.*&quot;));</span><br><span class="line">	é»˜è®¤æƒé™</span><br><span class="line">	.securityReferences(defaultAuth())</span><br><span class="line">	æŒ‡ä»£è·¯å¾„</span><br><span class="line">	.forPaths(PathSelectors.regex(pathRegex))</span><br><span class="line">	é»˜è®¤æƒé™</span><br><span class="line">		æˆæƒèŒƒå›´</span><br><span class="line">			AuthorizationScope authorizationScope &#x3D; new AuthorizationScope(&quot;global&quot;, &quot;accessEverything&quot;);</span><br><span class="line">     	result.add(new SecurityReference(&quot;Authorization&quot;, authorizationScopes));</span><br><span class="line">4âƒ£ï¸jsonä¼ å‚</span><br><span class="line">æ›´æ”¹LoginController&#x2F;login å‚æ•°æ³¨è§£@RequestBody ï¼Œæ›´æ”¹JwtTokenUtil&#x2F;generatorToken&#x2F;åŠ å¯†æ¨¡å¼HS512</span><br><span class="line">5âƒ£ï¸æ³¨æ„ï¼ŒSecurityConfig&#x2F;configureï¼ˆWebSecurity webï¼‰é‡Œé¢æ”¾è¡Œçš„é…ç½®ä¸SecurityConfig&#x2F;configure(HttpSecurity http)çš„æ”¾è¡Œé…ç½®é‡åˆï¼Œ</span><br><span class="line">å¯ä»¥å°†SecurityConfig&#x2F;configure(HttpSecurity http)çš„loginæ”¾è¡Œé…ç½®è¿›è¡Œæ³¨é‡Š</span><br><span class="line">	.antMatchers(&quot;&#x2F;login&quot;, &quot;&#x2F;logout&quot;)</span><br><span class="line">  .permitAll()</span><br><span class="line">6âƒ£ï¸è¿›è¡ŒAuthorizeè®¾ç½®ï¼Œå°†Bearerç©ºæ ¼tokonè¿›è¡Œä¿å­˜</span><br></pre></td></tr></table></figure>
<p>ç”ŸæˆéªŒè¯ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸å¼•å…¥GoogleéªŒè¯ç ä¾èµ–</span><br><span class="line">	 &lt;!--éªŒè¯ç --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.axet&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;kaptcha&lt;&#x2F;artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.0.9&lt;&#x2F;version&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">2âƒ£ï¸å‡†å¤‡è°·æ­ŒéªŒè¯ç é…ç½®ç±»</span><br><span class="line">	æ³¨è§£@Configuration</span><br><span class="line">	å‡†å¤‡bean</span><br><span class="line">	å…·ä½“é…ç½®</span><br><span class="line">				&#x2F;&#x2F;éªŒè¯ç ç”Ÿæˆå™¨</span><br><span class="line">        DefaultKaptcha defaultKaptcha &#x3D; new DefaultKaptcha();</span><br><span class="line">        &#x2F;&#x2F;é…ç½®</span><br><span class="line">        Properties properties &#x3D; new Properties();</span><br><span class="line">        &#x2F;&#x2F;æ˜¯å¦æœ‰è¾¹æ¡†</span><br><span class="line">        properties.setProperty(&quot;kaptcha.border&quot;, &quot;yes&quot;);</span><br><span class="line">        &#x2F;&#x2F;è®¾ç½®è¾¹æ¡†é¢œè‰²</span><br><span class="line">        properties.setProperty(&quot;kaptcha.border.color&quot;, &quot;105,179,90&quot;);</span><br><span class="line">        &#x2F;&#x2F;è¾¹æ¡†ç²—ç»†åº¦ï¼Œé»˜è®¤ä¸º1</span><br><span class="line">        &#x2F;&#x2F; properties.setProperty(&quot;kaptcha.border.thickness&quot;,&quot;1&quot;);</span><br><span class="line">        &#x2F;&#x2F;éªŒè¯ç </span><br><span class="line">        properties.setProperty(&quot;kaptcha.session.key&quot;, &quot;code&quot;);</span><br><span class="line">        &#x2F;&#x2F;éªŒè¯ç æ–‡æœ¬å­—ç¬¦é¢œè‰² é»˜è®¤ä¸ºé»‘è‰²</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.color&quot;, &quot;blue&quot;);</span><br><span class="line">        &#x2F;&#x2F;è®¾ç½®å­—ä½“æ ·å¼</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.names&quot;, &quot;å®‹ä½“,æ¥·ä½“,å¾®è½¯é›… é»‘&quot;);</span><br><span class="line">        &#x2F;&#x2F;å­—ä½“å¤§å°ï¼Œé»˜è®¤40</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.size&quot;, &quot;30&quot;);</span><br><span class="line">        &#x2F;&#x2F;éªŒè¯ç æ–‡æœ¬å­—ç¬¦å†…å®¹èŒƒå›´ é»˜è®¤ä¸ºabced2345678gfynmnpwx</span><br><span class="line">        &#x2F;&#x2F; properties.setProperty(&quot;kaptcha.textproducer.char.string&quot;, &quot;&quot;);</span><br><span class="line">        &#x2F;&#x2F;å­—ç¬¦é•¿åº¦ï¼Œé»˜è®¤ä¸º5</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.char.length&quot;, &quot;4&quot;);</span><br><span class="line">        &#x2F;&#x2F;å­—ç¬¦é—´è· é»˜è®¤ä¸º2</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.char.space&quot;, &quot;4&quot;);</span><br><span class="line">        &#x2F;&#x2F;éªŒè¯ç å›¾ç‰‡å®½åº¦ é»˜è®¤ä¸º200</span><br><span class="line">        properties.setProperty(&quot;kaptcha.image.width&quot;, &quot;100&quot;);</span><br><span class="line">        &#x2F;&#x2F;éªŒè¯ç å›¾ç‰‡é«˜åº¦ é»˜è®¤ä¸º40</span><br><span class="line">        properties.setProperty(&quot;kaptcha.image.height&quot;, &quot;40&quot;);</span><br><span class="line">        Config config &#x3D; new Config(properties);</span><br><span class="line">        defaultKaptcha.setConfig(config);</span><br><span class="line">        return defaultKaptcha;</span><br><span class="line">3âƒ£ï¸æ–°å»ºController</span><br><span class="line">	æ³¨è§£</span><br><span class="line">	ç±»æ³¨è§£  @RestController</span><br><span class="line">	@ApiOperation(value &#x3D; &quot;éªŒè¯ç &quot;)</span><br><span class="line">  @GetMapping(value &#x3D; &quot;&#x2F;captcha&quot;)</span><br><span class="line">  æ·»åŠ æ–¹æ³•captchaå‚æ•°ä¸ºï¼ˆHttpServletRequestï¼ŒHttpServletResponseï¼‰</span><br><span class="line">  é€šè¿‡æµä¼ é€’å›¾ç‰‡åˆ°å‰ç«¯,éœ€è¦å¯¹responseå“åº”å¤´åšç›¸åº”å¤„ç†</span><br><span class="line">  	response.setDateHeader(&quot;Expires&quot;, 0);</span><br><span class="line">    response.setHeader(&quot;Cache-Control&quot;, &quot;no-store, no-cache, must-revalidate&quot;);</span><br><span class="line">    response.addHeader(&quot;Cache-Control&quot;, &quot;post-check&#x3D;0, pre-check&#x3D;0&quot;);</span><br><span class="line">    response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);</span><br><span class="line">    response.setContentType(&quot;image&#x2F;jpeg&quot;);</span><br><span class="line">  æ³¨å…¥DefaultKaptcha</span><br><span class="line">  ç”ŸæˆéªŒè¯ç </span><br><span class="line">  è·å–éªŒè¯ç æ–‡æœ¬å†…å®¹</span><br><span class="line">  å°†éªŒè¯ç æ”¾å…¥session</span><br><span class="line">  æ ¹æ®textåˆ›å»ºå›¾åƒéªŒè¯ç </span><br><span class="line">  è¾“å‡ºæµè¾“å‡ºå›¾ç‰‡ï¼Œæ ¼å¼ä¸ºjpg</span><br><span class="line">4âƒ£ï¸æ·»åŠ æ”¾è¡ŒSecurityConfig&#x2F;configure(WebSecurity web)+&quot;&#x2F;captcha&quot;</span><br><span class="line">5âƒ£ï¸æ¥å£æ–‡æ¡£éªŒè¯ç ä¹±ç -åœ¨æ³¨è§£æ·»åŠ  @GetMapping(value &#x3D; &quot;&#x2F;captcha&quot;,produces &#x3D; &quot;image&#x2F;jpeg&quot;)</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç æ ¡éªŒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸åœ¨AdminLoginParamæ·»åŠ æ¥æ”¶å‚æ•°</span><br><span class="line">	@ApiModelProperty(value &#x3D; &quot;éªŒè¯ç &quot;,required &#x3D; true)</span><br><span class="line">    private String code;</span><br><span class="line">2âƒ£ï¸åœ¨LoginControllerï¼Œæ·»åŠ å‚æ•°éªŒè¯ç ï¼ŒåŒæ—¶åœ¨IAdminService&#x2F;AdminServiceImplä¹Ÿè¿›è¡Œæ”¹å˜</span><br><span class="line">3âƒ£ï¸åœ¨AdminServiceImplï¼Œè·å–éªŒè¯ç </span><br><span class="line">	String captcha &#x3D; (String) request.getSession().getAttribute(&quot;captcha&quot;);</span><br><span class="line">4âƒ£ï¸éªŒè¯ç æ¯”è¾ƒ</span><br><span class="line">	ä¸ä¸ºç©ºå‰ç«¯è¾“å…¥ä¸åç«¯éªŒè¯ç è¿›è¡ŒåŒ¹é…</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢èœå•åˆ—è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸æ›´æ”¹pojoå®ä½“ç±»Menu</span><br><span class="line">	 @ApiModelProperty(value &#x3D; &quot;å­èœå•&quot;)</span><br><span class="line">   @TableField(exist &#x3D; false)</span><br><span class="line">   private List&lt;Menu&gt; children;	</span><br><span class="line">2âƒ£ï¸æ›´æ”¹MenuController</span><br><span class="line">	æ›´æ”¹è·¯å¾„&#x2F;system&#x2F;cfg</span><br><span class="line">	æ³¨å…¥ IMenuService</span><br><span class="line">	åœ¨getMenuByAdminIdè¿”å›getMenusByAdminId</span><br><span class="line">	ç”¨æˆ·ä¿¡æ¯ä¸€èˆ¬æ˜¯ä»åç«¯è·å–ï¼Œè€Œä¸æ˜¯å‰ç«¯è·å–ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«ç¯¡æ”¹</span><br><span class="line">3âƒ£ï¸åœ¨IMenuServiceæ¥å£å®šä¹‰getMenusByAdminId</span><br><span class="line">4âƒ£ï¸åœ¨MenuServiceImplå®ç°getMenusByAdminId</span><br><span class="line">	return menuMapper.getMenusAdminId(((Admin)(SecurityContextHolder.getContext().getAuthentication().getPrincipal())).getId());</span><br><span class="line">5âƒ£ï¸åœ¨MenuMapperå®šä¹‰getMenusAdminId</span><br><span class="line">6âƒ£ï¸åœ¨MenuMapperå†™æŸ¥è¯¢æ–¹æ³• å®šä¹‰è¿”å›ç±»å‹</span><br><span class="line">	&lt;!--æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢èœå•åˆ—è¡¨--&gt;</span><br><span class="line">	&lt;select id&#x3D;&quot;getMenusAdminId&quot; resultMap&#x3D;&quot;Menus&quot;&gt;</span><br><span class="line">        select distinct m1.*,</span><br><span class="line">                        m2.id            as id2,</span><br><span class="line">                        m2.url           as url2,</span><br><span class="line">                        m2.path          as path2,</span><br><span class="line">                        m2.&#96;component&#96;   as component2,</span><br><span class="line">                        m2.name          as name2,</span><br><span class="line">                        m2.&#96;iconCls&#96;     as iconCls2,</span><br><span class="line">                        m2.&#96;keepAlive&#96;   as keepAlive2,</span><br><span class="line">                        m2.&#96;requireAuth&#96; as requireAuth2,</span><br><span class="line">                        m2.&#96;parentId&#96;    as parentId2,</span><br><span class="line">                        m2.enabled       as enabled2</span><br><span class="line">        from &#96;t_menu&#96; m1,</span><br><span class="line">             &#96;t_menu&#96; m2,</span><br><span class="line">             &#96;t_menu_role&#96; mr,</span><br><span class="line">             &#96;t_admin_role&#96; ar</span><br><span class="line">        where m1.id &#x3D; m2.&#96;parentId&#96;</span><br><span class="line">          and m2.id &#x3D; mr.&#96;mid&#96;</span><br><span class="line">          and mr.&#96;rid&#96; &#x3D; ar.&#96;rid&#96;</span><br><span class="line">          and ar.&#96;adminId&#96; &#x3D; #&#123;id&#125;</span><br><span class="line">          and m2.enabled &#x3D; true</span><br><span class="line">        order by m2.id</span><br><span class="line">    &lt;&#x2F;select&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;resultMap id&#x3D;&quot;Menus&quot; type&#x3D;&quot;com.zoux.server.pojo.Menu&quot; extends&#x3D;&quot;BaseResultMap&quot;&gt;</span><br><span class="line">        &lt;collection property&#x3D;&quot;children&quot; ofType&#x3D;&quot;com.zoux.server.pojo.Menu&quot;&gt;</span><br><span class="line">            &lt;id column&#x3D;&quot;id2&quot; property&#x3D;&quot;id&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;url2&quot; property&#x3D;&quot;url&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;path2&quot; property&#x3D;&quot;path&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;component2&quot; property&#x3D;&quot;component&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;name2&quot; property&#x3D;&quot;name&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;iconCls2&quot; property&#x3D;&quot;iconCls&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;keepAlive2&quot; property&#x3D;&quot;keepAlive&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;requireAuth2&quot; property&#x3D;&quot;requireAuth&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;parentId2&quot; property&#x3D;&quot;parentId&quot;&#x2F;&gt;</span><br><span class="line">            &lt;result column&#x3D;&quot;enabled2&quot; property&#x3D;&quot;enabled&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;collection&gt;</span><br><span class="line">    &lt;&#x2F;resultMap&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Redisé›†æˆèœå•åŠŸèƒ½</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸æ·»åŠ ä¾èµ–</span><br><span class="line">	&lt;!--spring data redis ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">        &lt;!--commons-pool2 å¯¹è±¡æ± ä¾èµ–--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.commons&lt;&#x2F;groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;commons-pool2&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;&#x2F;dependency&gt;</span><br><span class="line">2âƒ£ï¸æ·»åŠ é…ç½®application.yml </span><br><span class="line">	redis:</span><br><span class="line">    #è¶…æ—¶æ—¶é—´</span><br><span class="line">    timeout:  10000ms</span><br><span class="line">    #æœåŠ¡å™¨åœ°å€</span><br><span class="line">    host: 47.100.92.101</span><br><span class="line">    #æœåŠ¡å™¨ç«¯å£</span><br><span class="line">    port: 6379</span><br><span class="line">    database: 0</span><br><span class="line">    #    password: root</span><br><span class="line">    lettuce:</span><br><span class="line">      #é»˜è®¤è¿æ¥æ•°ï¼Œé»˜è®¤æ˜¯8</span><br><span class="line">      max-active: 1024</span><br><span class="line">      #æœ€å¤§è¿æ¥é˜»å¡ç­‰å¾…æ—¶é—´</span><br><span class="line">      max-wait: 1000ms</span><br><span class="line">      #æœ€å¤§ç©ºé—²è¿æ¥</span><br><span class="line">      max-idle: 200</span><br><span class="line">      #æœ€å°ç©ºé—²è¿æ¥</span><br><span class="line">      min-idle: 5</span><br><span class="line">3âƒ£ï¸æ–°å»ºredisé…ç½®ç±»RedisConfig å‚æ•°RedisConnectionFactory</span><br><span class="line">	å¼•å…¥Bean RedisTemplate</span><br><span class="line">	åºåˆ—åŒ–</span><br><span class="line">	Stringç±»å‹åºåˆ—å™¨</span><br><span class="line">	 Hashç±»å‹åºåˆ—å™¨</span><br><span class="line">	 å°†RedisConnectionFactory åŠ å…¥åˆ°RedisTemplate</span><br><span class="line">4âƒ£ï¸æ›´æ”¹Menucontroller-&gt;IMenuService-&gt;MenuServiceImpl&#x2F;getMenusByAdminIdæ–¹æ³•</span><br><span class="line">	æ³¨å…¥RedisTemplate</span><br><span class="line">	å…ˆå»redisè·å–</span><br><span class="line">	åˆ¤æ–­menusæ˜¯å¦ä¸ºç©º,å°±é€šè¿‡æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢</span><br><span class="line">		å°†æ•°æ®è®¾ç½®åˆ°redisä¸­</span><br><span class="line">5âƒ£ï¸åæœŸï¼Œå½“æ¶‰åŠåˆ°æ•°æ®èœå•æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬è¦é‡ç½®redisé‡Œé¢çš„æ•°æ®</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®è¯·æ±‚urlåˆ¤æ–­è§’è‰²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">æƒé™RBACåŸºæœ¬æ¦‚å¿µ</span><br><span class="line">	Role- Based Access Controller</span><br><span class="line">	æƒé™ä¸è§’è‰²ç›¸å…³è”ï¼Œç”¨æˆ·é€šè¿‡æ‰®æ¼”é€‚å½“çš„è§’è‰²ä»è€Œå¾—åˆ°è¿™äº›è§’è‰²çš„æƒé™ã€‚</span><br><span class="line">	ç®¡ç†æ˜¯å±‚çº§ç›¸äº’ä¾èµ–çš„ï¼Œæƒé™èµ‹äºˆç»™è§’è‰²ï¼Œè§’è‰²åˆèµ‹äºˆç”¨æˆ·ã€‚</span><br><span class="line">	æƒé™è®¾è®¡æ¸…æ¥šï¼Œç®¡ç†æ–¹ä¾¿</span><br><span class="line">	RBACå®é™…ä¸Šæ˜¯who what howä¸‰å…ƒç»„ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯who å¯¹whatè¿›è¡Œhowçš„æ“ä½œ</span><br><span class="line">	è°å¯¹ä»€ä¹ˆèµ„æºåšäº†æ€æ ·çš„æ“ä½œã€‚</span><br><span class="line">	</span><br><span class="line">1âƒ£ï¸pojo-Menuæ·»åŠ å±æ€§</span><br><span class="line">		@ApiModelProperty(value &#x3D; &quot;è§’è‰²åˆ—è¡¨&quot;)</span><br><span class="line">    @TableField(exist &#x3D; false)</span><br><span class="line">    private List&lt;Menu&gt; roles;</span><br><span class="line">2âƒ£ï¸åœ¨IMenuServiceå®šä¹‰getMenusWithRole</span><br><span class="line">3âƒ£ï¸åœ¨MenuServiceImplå®ç°getMenusWithRole</span><br><span class="line">4âƒ£ï¸åœ¨MenuMapperå®šä¹‰getMenusWithRole</span><br><span class="line">5âƒ£ï¸åœ¨MenuMapper.xmlå®ç°sql</span><br><span class="line">	å¹¶å®ç°è¿”å›map</span><br><span class="line">6âƒ£ï¸å°†å®ç°çš„getMenusWithRoleæ”¾å…¥è¿‡æ»¤å™¨ä¸­</span><br><span class="line">	é¡ºä¾¿æ›´æ–°configç›®å½•ç»“æ„ï¼Œé‡å¯é¡¹ç›®ï¼ŒéªŒè¯æ˜¯å¦å‡ºç°é”™è¯¯</span><br><span class="line">7âƒ£ï¸	æ–°å»ºCustomFilteré…ç½®ç±»</span><br><span class="line">	æ³¨è§£@Component</span><br><span class="line">	å®ç°FilterInvocationSecurityMetadataSourceé‡å†™å†…éƒ¨æ–¹æ³• getAttributes</span><br><span class="line">	æ³¨å…¥IMenuService</span><br><span class="line">	å¼•å…¥AntPathMatcher</span><br><span class="line">		åœ¨åšuriåŒ¹é…è§„åˆ™å‘ç°è¿™ä¸ªç±»ï¼Œæ ¹æ®æºç å¯¹è¯¥ç±»è¿›è¡Œåˆ†æï¼Œå®ƒä¸»è¦ç”¨æ¥åšç±»URLså­—ç¬¦ä¸²åŒ¹é…ï¼›</span><br><span class="line">		è·å–è¯·æ±‚çš„url</span><br><span class="line">		è·å¾—menus</span><br><span class="line">		å¾ªç¯åˆ¤æ–­ æˆ‘ä»¬å½“å‰çš„urlä¸è·å–çš„urlæ˜¯å¦åŒ¹é…</span><br><span class="line">		åˆ¤æ–­è¯·æ±‚urlä¸è§’è‰²å…è®¸urlæ˜¯å¦åŒ¹é…</span><br><span class="line">		åˆ©ç”¨jdk8æ–°ç‰¹æ€§streamæµmapä¸€ä¸‹</span><br><span class="line">		èƒ½å¤ŸåŒ¹é…å°±å°†åŒ¹é…çš„è§’è‰²æ”¾å…¥&#x2F;list</span><br><span class="line">		å¦‚æœurlåŒ¹é…ä¸ä¸Šå°±é»˜è®¤ç»™ä¸€ä¸ªç™»é™†è§’è‰²</span><br></pre></td></tr></table></figure>
<p>åˆ¤æ–­ç”¨æˆ·è§’è‰²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">1âƒ£ï¸ä¿®æ”¹pojo-Admin</span><br><span class="line">		@ApiModelProperty(value &#x3D; &quot;è§’è‰²&quot;)</span><br><span class="line">    @TableField(exist &#x3D; false)</span><br><span class="line">    private List&lt;Role&gt; roles;</span><br><span class="line">    æ›´æ”¹getAuthorities</span><br><span class="line">    	è·å–æƒé™åˆ—è¡¨</span><br><span class="line">2âƒ£ï¸IAdminServiceå®šä¹‰getRoles</span><br><span class="line">3âƒ£ï¸åœ¨AdminServiceImplå®ç°getRoles</span><br><span class="line">	æ³¨å…¥RoleMapper</span><br><span class="line">	æ–°å»ºæ–¹æ³•getRoles</span><br><span class="line">4âƒ£ï¸åœ¨RoleMapperå®šä¹‰getRoles</span><br><span class="line">5âƒ£ï¸åœ¨RoleMapper.xmlä¸­å®ç°sql</span><br><span class="line">7âƒ£ï¸åœ¨ç™»å½•æ–¹æ³•ä¸­åŠ å…¥getRoles</span><br><span class="line">	åœ¨LoginController-getAdminInfo&#x2F;loadUserByUsernameå®ç°æ–¹æ³•</span><br><span class="line">		æ·»åŠ è·å–ç”¨æˆ·è§’è‰²    </span><br><span class="line">8âƒ£ï¸æ·»åŠ æ‹¦æˆª</span><br><span class="line">	æ–°å»ºç±»CustomUrlDecisionManager</span><br><span class="line">		æ³¨è§£@Component</span><br><span class="line">		å®ç°AccessDecisionManagerï¼Œå¹¶é‡å†™å…¶æ–¹æ³•decide</span><br><span class="line">			è·å–å½“å‰urléœ€è¦è§’è‰²</span><br><span class="line">			åˆ¤æ–­è§’è‰²æ˜¯å¦ç™»é™†å³å¯è®¿é—®çš„è§’è‰²ï¼Œæ­¤è§’è‰²åœ¨CustomFilterä¸­è®¾ç½®</span><br><span class="line">			åˆ¤æ–­æ˜¯å¦ç™»é™†</span><br><span class="line">			åˆ¤æ–­ç”¨æˆ·è§’è‰²æ˜¯å¦ä¸ºurlæ‰€éœ€è§’è‰²</span><br><span class="line">			å¦‚è‹¥ä¸æ»¡è¶³ï¼ŒæŠ›å‡ºå¼‚å¸¸</span><br><span class="line">				throw new AccessDeniedException(&quot;æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&quot;);</span><br><span class="line">9âƒ£ï¸é…ç½®securityconfig</span><br><span class="line">	å¼•å…¥CustomFilterï¼ŒCustomUrlDecisionManager</span><br><span class="line">	åœ¨è®¿é—®è¯·æ±‚è¦æ±‚è®¤è¯ä¸‹æ·»åŠ </span><br><span class="line">		åŠ¨æ€æƒé™é…ç½®</span><br><span class="line">		.withObjectPostProcessor()</span><br><span class="line">			new ObjectPostProcessorèŒƒå‹ä¸ºFilterSecurityInterceptoré‡å†™å…¶æ–¹æ³•postProcess</span><br><span class="line">				æ·»åŠ CustomFilterï¼ŒCustomUrlDecisionManager</span><br><span class="line">					o.setAccessDecisionManager(customUrlDecisionManager);</span><br><span class="line">          o.setSecurityMetadataSource(customFilter);</span><br><span class="line">        è¿”å›o</span><br><span class="line">ğŸ”Ÿå‡†å¤‡æµ‹è¯•ç±»</span><br><span class="line">	HelloController</span><br><span class="line">	æ³¨è§£@RestController</span><br><span class="line">		@GetMapping(&quot;&#x2F;employee&#x2F;basic&#x2F;hello&quot;)</span><br><span class="line">    public String hello2() &#123;</span><br><span class="line">        return &quot;&#x2F;employee&#x2F;basic&#x2F;hell&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;hello&quot;)</span><br><span class="line">    public String hello() &#123;</span><br><span class="line">        return &quot;hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;&#x2F;employee&#x2F;advanced&#x2F;hello&quot;)</span><br><span class="line">    public String hello3() &#123;</span><br><span class="line">        return &quot;&#x2F;employee&#x2F;advanced&#x2F;hello&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

  </div>
  <div> 
    <a href="https://github.com/Zoushaozx/zoushaozx.github.io/edit/myblog/source/_posts/äº‘eåŠ.md" target="_blank">
             <!-- https://github.com/Zoushaozx/zoushaozx.github.io/edit/myblog/source/_posts/hello-world.md -->
      ç¼–è¾‘
    </a>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/projects">é¡¹ç›®</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%91e%E5%8A%9E%EF%BC%8C%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%EF%BC%8C%E5%89%8D%E7%AB%AFvue-%E5%90%8E%E7%AB%AFJava"><span class="toc-number">1.</span> <span class="toc-text">äº‘eåŠï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯vue åç«¯Java</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.1.</span> <span class="toc-text">åç«¯æŠ€æœ¯æ ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.2.</span> <span class="toc-text">å‰ç«¯æŠ€æœ¯æ ˆ</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&text=äº‘eåŠ"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&is_video=false&description=äº‘eåŠ"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=äº‘eåŠ&body=Check out this article: http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&title=äº‘eåŠ"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&name=äº‘eåŠ&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2021/02/12/%E4%BA%91e%E5%8A%9E/&t=äº‘eåŠ"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2021
    Zoux
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/projects">é¡¹ç›®</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸ!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
